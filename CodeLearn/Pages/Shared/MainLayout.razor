@inherits LayoutComponentBase
@using Microsoft.AspNetCore.Identity
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor httpContextAccsessor
@inject IUserRepository UserRepository

    <MudThemeProvider Theme="MCGTheme" />
    <MudDialogProvider />
    <MudSnackbarProvider />

    <MudLayout>
        <NavBar />

        <MudMainContent>
            <MudContainer MaxWidth="MaxWidth.Large">

                <CascadingValue Value="_userId">
                    @Body
                </CascadingValue>

                    <MudScrollToTop>
                        <MudFab Color="Color.Success" Icon="@Icons.Filled.ArrowCircleUp" />
                    </MudScrollToTop>
            </MudContainer>

        </MudMainContent>

        <Footer />
    </MudLayout>


@code{
    MudTheme MCGTheme = new()
    {
        Palette = new Palette()
        {
            Primary = "#19B33D",
            AppbarBackground = "#19B33D",
        }
    };

    Guid _userId;

    protected override void OnInitialized()
    {
        if (httpContextAccsessor.HttpContext.User.Identity.IsAuthenticated == true)
        {
            User user =  UserRepository.GetUserByName(httpContextAccsessor.HttpContext.User.Identity.Name);
            _userId = user.Id;
        }
    }
}