@using Microsoft.AspNetCore.Identity
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor httpContextAccessor
@inherits LayoutComponentBase
@inject IHttpContextAccessor httpContextAccsessor
@inject IUserRepository UserRepository

    <MudThemeProvider Theme="MCGTheme" />
    <MudDialogProvider />
    <MudSnackbarProvider />

    <MudLayout>
        <NavBar />
        <MudMainContent>
            <MudContainer MaxWidth="MaxWidth.Large">

                <CascadingValue Value="_userId">
                    <MudGrid>

                    <MudItem Style="height : fit-content" xs="12" sm="3">
                        <CodeLearn.Component.DashBoard.Menu.DashBoardMenu></CodeLearn.Component.DashBoard.Menu.DashBoardMenu>
                    </MudItem>
                    <MudItem xs="12" sm="9">
                        @Body
                    </MudItem>
                    </MudGrid>
                </CascadingValue>

                <MudScrollToTop>
                    <MudFab Color="Color.Success" Icon="@Icons.Filled.ArrowCircleUp" />
                </MudScrollToTop>
            </MudContainer>

        </MudMainContent>
        

        
        <Footer />
    </MudLayout>


@code{
    bool _drawerOpen = false;

    MudTheme MCGTheme = new()
    {
        Palette = new Palette()
        {
            Primary = "#19B33D",
            AppbarBackground = "#19B33D",
            
        }
    };

    Guid _userId;

    protected override void OnInitialized()
    {
        if (httpContextAccsessor.HttpContext.User.Identity.IsAuthenticated == true)
        {
            User user =  UserRepository.GetUserByName(httpContextAccsessor.HttpContext.User.Identity.Name);
            _userId = user.Id;
        }
    }
}