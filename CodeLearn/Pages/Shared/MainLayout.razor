@using Microsoft.AspNetCore.Identity
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor httpContextAccessor
@inherits LayoutComponentBase
@inject IUserRepository UserRepository

<MudThemeProvider Theme="MCGTheme" />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>
    <NavBar />
    <MudMainContent>
        <CascadingValue Value="@_userId" Name="_userId">
            <MudContainer MaxWidth="MaxWidth.Large">
                @Body
            </MudContainer>
        </CascadingValue>
    </MudMainContent>
    <Footer />
</MudLayout>

@code{
    Guid _userId;
    MudTheme MCGTheme = new()
    {
        Palette = new Palette()
        {
            Primary = "#19B33D",
            AppbarBackground = "#19B33D",
        }
    };
    protected override async Task OnInitializedAsync()
    {
        if(httpContextAccessor.HttpContext.User.Identity.IsAuthenticated == true)
        _userId = UserRepository.GetUserByName(httpContextAccessor.HttpContext.User.Identity.Name).Id;
    }
}