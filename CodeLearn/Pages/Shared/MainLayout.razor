@inherits LayoutComponentBase
@inject IUserRepository UserRepository;

    <MudThemeProvider Theme="MCGTheme" />
    <MudDialogProvider />
    <MudSnackbarProvider />

    <MudLayout>
        <NavBar />

        <MudMainContent>
            <MudContainer MaxWidth="MaxWidth.Large">

                <CascadingValue Value="_userTask">
                    @Body
                </CascadingValue>

                    <MudScrollToTop>
                        <MudFab Color="Color.Success" Icon="@Icons.Filled.ArrowCircleUp" />
                    </MudScrollToTop>
            </MudContainer>

        </MudMainContent>

        <Footer />
    </MudLayout>

@code{ 
    MudTheme MCGTheme = new()
    {
        Palette = new Palette()
        {
            Primary = "#19B33D",
            AppbarBackground = "#19B33D",
        }
    };

    [CascadingParameter]
    private Task<AuthenticationState> _authenticationStateTask { get; set; }

    private Task<User> _userTask;

    protected override void OnInitialized()
    {
        _userTask = GetUser();
    }

    private async Task<User> GetUser()
    {
        var authState = await _authenticationStateTask;
        var identityUser = authState.User;

        if (identityUser.Identity.IsAuthenticated)
          return await UserRepository.GetUserByEmailAsync(identityUser.FindFirst(ClaimTypes.Email).Value);
        
        else
            return null;
    }
}